---
title: "gaussian-model-sensitivity"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{gaussian-model-sensitivity}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

Global Sensitivity Analysis has the goal of breaking a mathematical model's tough rind, allowing us to look inside. 
Let's assume that we are modeling a problem where two quantities of interest, $\mathbf{Y} = \{Y_1, Y_2\}$, are defined as a function of three variables, $\mathbf{X} = (X_1, X_2, X_3)$. We express this dependence through a linear transformation $\mathbf{Y} = A\mathbf{X}$, where 
$$
A = \begin{bmatrix}
      4 & 2 & 3 \\
      2 & 5 & -1 
    \end{bmatrix}.
$$
We assume that the inputs are uncertain and that this uncertainty can be modeled using a multivariate normal distribution, $\mathbf{X} \sim \mathcal{N}(\mathbf{\mu}, \Sigma)$, with $\mu = (1,1,1)$ and 
$$
\Sigma = \begin{bmatrix}
            1 & 0.5 & 0.5 \\
            0.5 & 1 & 0.5 \\
            0.5 & 0.5 & 1
          \end{bmatrix}.
$$
To perform an uncertainty quantification of the model, under the assumed distribution for the inputs, we can use a simple Monte Carlo simulation. We generate the input sample (`x`), and we estimate the model output (`y`) for each input. 
We can define the model and simulate it in R using the following code block.

```{r}
mx <- c(1, 1, 1)
Sigmax <- matrix(data = c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), nrow = 3)

N <- 1000

x1 <- rnorm(N)
x2 <- rnorm(N)
x3 <- rnorm(N)

x <- cbind(x1, x2, x3)
x <- mx + x %*% chol(Sigmax)

A <- matrix(data = c(4, -2, 1, 2, 5, -1), nrow = 2, byrow = TRUE)
y <- t(A %*% t(x))

x <- data.frame(x)
y <- y
```
We can plot the distribution of the output using the base plotting functions of R.
```{r, fig.width=7}
par(mfrow=c(1,2))
plot(density(y[,1]), xlab = "y1", main = "Marginal density of y1")
plot(density(y[,2]), xlab = "y2", main = "Marginal density of y2")
```
